<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico de Imagen JPG</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1b26;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .test-container {
            background: rgba(89, 150, 194, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .test-image {
            max-width: 100%;
            height: auto;
            border: 2px solid #5996C2;
            margin: 20px 0;
        }
        .info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .error {
            background: rgba(255, 0, 0, 0.2);
            color: #ff6b6b;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîç Diagn√≥stico de Imagen JPG</h1>

    <div class="info">
        <h3>üìã Informaci√≥n del Archivo</h3>
        <p><strong>Archivo:</strong> Imagen_maching_lerning_aplicado.jpg</p>
        <p><strong>Ruta:</strong> ./Certificados/Imagen_maching_lerning_aplicado.jpg</p>
        <p><strong>Objetivo:</strong> Diagnosticar problemas de carga de imagen</p>
    </div>

    <div class="test-container">
        <h3>üß™ Prueba 1: Carga Directa</h3>
        <img src="./Certificados/Imagen_maching_lerning_aplicado.jpg"
             alt="Imagen de certificado Machine Learning"
             class="test-image"
             onload="document.getElementById('direct-status').textContent='‚úÖ Imagen cargada correctamente'"
             onerror="document.getElementById('direct-status').textContent='‚ùå Error cargando imagen directa'">
        <p id="direct-status">Cargando imagen directa...</p>
    </div>

    <div class="test-container">
        <h3>üîß Prueba 2: Verificaci√≥n con Fetch</h3>
        <button onclick="testFetch()">Probar con Fetch</button>
        <div id="fetch-results"></div>
    </div>

    <div class="test-container">
        <h3>üìä Prueba 3: Informaci√≥n T√©cnica</h3>
        <button onclick="testTechnical()">An√°lisis T√©cnico</button>
        <div id="technical-results"></div>
    </div>

    <script>
        console.log('üîç Iniciando diagn√≥stico de imagen JPG...');

        // Funci√≥n para probar fetch
        async function testFetch() {
            const resultsDiv = document.getElementById('fetch-results');
            resultsDiv.innerHTML = '<p>üîÑ Probando fetch...</p>';

            try {
                const response = await fetch('./Certificados/Imagen_maching_lerning_aplicado.jpg');
                console.log('üåê Respuesta fetch:', response.status, response.statusText);
                console.log('üîç Content-Type:', response.headers.get('content-type'));

                resultsDiv.innerHTML = `
                    <div class="info">
                        <h4>‚úÖ Resultados de Fetch:</h4>
                        <p><strong>Estado:</strong> ${response.status} ${response.statusText}</p>
                        <p><strong>Tipo MIME:</strong> ${response.headers.get('content-type')}</p>
                        <p><strong>Accesible:</strong> ${response.ok ? '‚úÖ S√≠' : '‚ùå No'}</p>
                    </div>
                `;

                if (response.ok) {
                    const blob = await response.blob();
                    console.log('üì¶ Blob:', blob.type, blob.size, 'bytes');

                    const reader = new FileReader();
                    reader.onload = () => {
                        const dataUrl = reader.result;
                        console.log('‚úÖ Data URL tipo MIME:', dataUrl.substring(5, dataUrl.indexOf(';')));

                        resultsDiv.innerHTML += `
                            <div class="info">
                                <h4>üìã Informaci√≥n del Blob:</h4>
                                <p><strong>Tipo:</strong> ${blob.type}</p>
                                <p><strong>Tama√±o:</strong> ${blob.size} bytes</p>
                                <p><strong>Data URL tipo:</strong> ${dataUrl.substring(5, dataUrl.indexOf(';'))}</p>
                            </div>
                        `;
                    };
                    reader.readAsDataURL(blob);
                }

            } catch (error) {
                console.error('‚ùå Error en fetch:', error);
                resultsDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Error en Fetch:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Funci√≥n para an√°lisis t√©cnico
        async function testTechnical() {
            const resultsDiv = document.getElementById('technical-results');
            resultsDiv.innerHTML = '<p>üîÑ Analizando t√©cnicamente...</p>';

            try {
                const response = await fetch('./Certificados/Imagen_maching_lerning_aplicado.jpg');
                const blob = await response.blob();

                resultsDiv.innerHTML = `
                    <div class="info">
                        <h4>üî¨ An√°lisis T√©cnico:</h4>
                        <p><strong>Tipo MIME del servidor:</strong> ${response.headers.get('content-type')}</p>
                        <p><strong>Tipo del blob:</strong> ${blob.type}</p>
                        <p><strong>Tama√±o del blob:</strong> ${blob.size} bytes</p>
                        <p><strong>¬øEs imagen JPG?:</strong> ${blob.type === 'image/jpeg' ? '‚úÖ S√≠' : '‚ùå No'}</p>
                    </div>
                `;

                // Verificar si el archivo es realmente una imagen JPG
                if (blob.type !== 'image/jpeg') {
                    resultsDiv.innerHTML += `
                        <div class="error">
                            <h4>üö® Problema Detectado:</h4>
                            <p>El servidor est√° devolviendo tipo MIME incorrecto.</p>
                            <p><strong>Soluci√≥n:</strong> El servidor necesita configuraci√≥n correcta para archivos JPG.</p>
                        </div>
                    `;
                }

            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Error T√©cnico:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Auto-ejecutar an√°lisis inicial
        window.addEventListener('load', () => {
            console.log('üöÄ P√°gina de diagn√≥stico cargada');
            setTimeout(testTechnical, 1000);
        });
    </script>
</body>
</html>
